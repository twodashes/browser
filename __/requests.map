{"version":3,"sources":["urls.js","requests.js"],"names":["querystring_from_object","params","qs","Object","keys","map","k","encodeURIComponent","join","object_from_querystring","str","obj","pairs","replace","split","pair","tuple","key","decodeURIComponent","trim","querystring_replace_key_value","queryString","value","str_trim_char","JSON","parse","decodeURI","output","entries","defineProperty","exports","window","browser","func","__","s","c","RegExp","urls","require","load_script","source","beforeEl","scriptAttrs","document","Promise","resolve","reject","script","createElement","async","defer","onloadHander","_","isAbort","readyState","test","onload","onreadystatechange","undefined","src","body","append","http_get","url","data","options","fetch","method","mode","cache","credentials","redirect","referrer","headers","cors","then","response","json","http_post","stringify","http_put","http_ajax","Error"],"mappings":"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","file":"requests.map","sourceRoot":"../cjs","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n/**\n * Convert JavaScript Object to URL querystring\n * ex: \"?one=1&two=something\"\n * @param {object} params - JS Object of key-value query params\n * @return {string} - starting with \"?\". Just that if empty object\n */\nfunction querystring_from_object(params = {}) {\n  let qs = Object.keys(params)\n    .map((k) => encodeURIComponent(k) + \"=\" + encodeURIComponent(params[k]))\n    .join(\"&\");\n  if (qs) {\n    qs = \"?\" + qs;\n  }\n  return qs;\n}\n\n/**\n * Parse the URL querystring to JavaScript Object\n * ex: \"?one=1&two=something\" => {one:1,two:'something'}\n * @param {string} str - starting with \"?\"\n * @return {object}\n */\nfunction object_from_querystring(str = \"\") {\n  // make object\n  let obj = {};\n  let pairs = str.replace(\"?\", \"\").split(\"&\");\n  for (let pair of pairs) {\n    if (!pair) continue;\n    let tuple = pair.split(\"=\");\n    let key = tuple[0];\n    if (!key) continue;\n    obj[key] = tuple[1] || \"\";\n  }\n  // decode value\n  for (let key in obj) {\n    obj[key] = decodeURIComponent(obj[key] || \"\").trim();\n  }\n  // done\n  return obj;\n}\n\n/**\n * Change a url (GET) parameter in queryString string\n * @param queryString {string} - ex: \"?start=10&fruit=apple\"\n * @param key {string} - ex: \"fruit\"\n * @param value {string} - ex: \"species\"\n * @return {string} - ex: \"?start=10&species=apple\"\n */\nfunction querystring_replace_key_value(queryString, key, value) {\n  // clean input\n  queryString = str_trim_char(queryString, \"&\");\n  queryString = str_trim_char(queryString, \"?\");\n  let obj = JSON.parse(\n    '{\"' + decodeURI(queryString).replace(/\"/g, '\\\\\"').replace(/&/g, '\",\"').replace(/=/g, '\":\"') + '\"}'\n  );\n  // replace value\n  obj[key] = value;\n  // rebuild queryString with replaced value\n  let output = \"?\";\n  for (let pair of Object.entries(obj)) {\n    output += pair[0] + \"=\";\n    output += pair[1] + \"&\";\n  }\n  return str_trim_char(output, \"&\");\n}\n\n/*\n * EXPORT FOR BROWSER\n */\nif (typeof window === \"object\") {\n  const browser = { object_from_querystring, querystring_from_object, querystring_replace_key_value };\n  // set up for export\n  window.__ = window.__ || {};\n  // flatten\n  for (let func in browser) {\n    window.__[func] = browser[func];\n  }\n}\n\n/*\n * PRIVATE FUNCTIONS BELOW\n */\n\n// /univeral\nfunction str_trim_char(s, c) {\n  if (c === \"]\") c = \"\\\\]\";\n  if (c === \"\\\\\") c = \"\\\\\\\\\";\n  return s.replace(new RegExp(\"^[\" + c + \"]+|[\" + c + \"]+$\", \"g\"), \"\");\n}\n\nexports.object_from_querystring = object_from_querystring;\nexports.querystring_from_object = querystring_from_object;\nexports.querystring_replace_key_value = querystring_replace_key_value;\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar urls = require('./urls.js');\n\n/**\n * Parse Axios error message\n * @param {string} source - external URL to load\n * @param {object} beforeEl - DOM element before which to insert the new <script> tag\n * @param {object} scriptAttrs - object of attributes to add to the new <script> tag\n */\nfunction load_script(source, beforeEl, scriptAttrs = {}) {\n  if (!source) return false;\n  if (typeof window !== \"object\" || typeof document !== \"object\") return false;\n  return new Promise((resolve, reject) => {\n    let script = document.createElement(\"script\");\n\n    // force certain attributes\n    script.async = true;\n    script.defer = true;\n    for (let key in scriptAttrs) {\n      script[key] = scriptAttrs[key];\n    }\n\n    // NOTE: needs refactor: maybe .bind(script)\n    function onloadHander(_, isAbort) {\n      if (isAbort || !script.readyState || /loaded|complete/.test(script.readyState)) {\n        script.onload = null;\n        script.onreadystatechange = null;\n        script = undefined;\n\n        if (isAbort) {\n          reject();\n        } else {\n          resolve();\n        }\n      }\n    }\n\n    script.onload = onloadHander;\n    script.onreadystatechange = onloadHander;\n\n    script.src = source;\n    window.document.body.append(script);\n    resolve(true);\n  });\n}\n\n/**\n * GET request\n * @param {string} url - including protocol, not including query params\n * @param {object|undefined} data - url query params as a JS object\n * @param {object} options - override defaults:\n *    ```\n *    {mode:\"cors\", cache: \"no-cache\", redirect: \"follow\", referrer: \"no-referrer\", headers: {}}\n *    ```\n * @returns {Promise} - promise will resolve with response data\n */\nfunction http_get(url = ``, data = undefined, options = {}) {\n  options = {\n    method: \"GET\",\n    mode: \"cors\",\n    cache: \"no-cache\",\n    credentials: \"same-origin\",\n    redirect: \"follow\",\n    referrer: \"no-referrer\",\n    headers: {},\n    ...options\n  };\n  if (data && typeof urls.querystring_from_object === \"function\") {\n    url = url + urls.querystring_from_object(data);\n  }\n  return fetch(url + urls.querystring_from_object(data), {\n    method: options.method, // *GET, POST, PUT, DELETE, etc.\n    mode: options.cors, // no-cors, cors, *same-origin\n    cache: options.cache, // no-cache, reload, force-cache, only-if-cached\n    credentials: options.credentials, // include, *same-origin, omit\n    headers: options.headers, // {}, {\"Content-Type\": \"application/json; charset=utf-8\"}\n    redirect: options.redirect, // manual, *follow, error\n    referrer: options.referrer // no-referrer, *client\n  })\n    .then((response) => response.json()) // parses response to JSON\n    .then((response) => response.data);\n}\n\n/**\n * POST request\n * @param {string} url\n * @param {object} data\n * @returns {Promise}\n */\nfunction http_post(url = ``, data = {}) {\n  // Auth\n  // url = url;\n  // Default options are marked with *\n  return fetch(url, {\n    method: \"POST\", // *GET, POST, PUT, DELETE, etc.\n    mode: \"cors\", // no-cors, cors, *same-origin\n    cache: \"no-cache\", // *default, no-cache, reload, force-cache, only-if-cached\n    credentials: \"same-origin\", // include, *same-origin, omit\n    headers: {\n      \"Content-Type\": \"application/json; charset=utf-8\"\n      // \"Content-Type\": \"application/x-www-form-urlencoded\",\n    },\n    redirect: \"follow\", // manual, *follow, error\n    referrer: \"no-referrer\", // no-referrer, *client\n    body: JSON.stringify(data) // body data type must match \"Content-Type\" header\n  }).then((response) => response.json()); // parses response to JSON\n}\n\n/**\n * PUT request\n * @param {string} url\n * @param {object} data\n * @returns {Promise}\n */\nfunction http_put(url = ``, data = {}) {\n  // Auth\n  // url = url;\n  // Default options are marked with *\n  return fetch(url, {\n    method: \"PUT\", // *GET, POST, PUT, DELETE, etc.\n    mode: \"cors\", // no-cors, cors, *same-origin\n    cache: \"no-cache\", // *default, no-cache, reload, force-cache, only-if-cached\n    credentials: \"same-origin\", // include, *same-origin, omit\n    headers: {\n      \"Content-Type\": \"application/json; charset=utf-8\"\n      // \"Content-Type\": \"application/x-www-form-urlencoded\",\n    },\n    redirect: \"follow\", // manual, *follow, error\n    referrer: \"no-referrer\", // no-referrer, *client\n    body: JSON.stringify(data) // body data type must match \"Content-Type\" header\n  }).then((response) => response.json()); // parses response to JSON\n}\n\n/**\n * Universal AJAX request coming soon...\n * @param url\n * @param method\n * @param data\n * @param headers\n * @param options\n * @returns {Promise}\n */\nfunction http_ajax(url, method = \"GET\", data = undefined, headers = {}, options = {}) {\n  data = data || undefined;\n  headers = { \"Content-Type\": \"application/json\", ...headers };\n  /*\n   * for front-end:\n   */\n  if (typeof fetch === \"function\") {\n    options = {\n      method: method,\n      mode: \"cors\",\n      cache: \"no-cache\",\n      credentials: \"same-origin\",\n      redirect: \"follow\",\n      referrer: \"no-referrer\",\n      headers,\n      ...options\n    };\n    return fetch(url, options)\n      .then((response) => response.json()) // parses response to JSON\n      .then((response) => response.data);\n  }\n  /*\n   * error:\n   */\n  if (typeof window === \"object\") {\n    throw new Error(\"Sorry. Your browser does not support this feature.\");\n  }\n}\n\nexports.http_ajax = http_ajax;\nexports.http_get = http_get;\nexports.http_post = http_post;\nexports.http_put = http_put;\nexports.load_script = load_script;\n"]}